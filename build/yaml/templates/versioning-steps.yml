steps:
  - powershell: |
     # Replace {DateStamp} and {CommitHash} tokens with the actual values in vars ReleasePackageVersion and PreviewPackageVersion
     $dateStamp = (Get-Date -format "yyyyMMdd");
     $commitHash = "$(Build.SourceVersion)".SubString(0,7);

     $ppv = $dateStamp + "." + $commitHash;
     Write-Host "##vso[task.setvariable variable=PackageVersion;]$ppv";
     "Resolved PackageVersion = $ppv";
    displayName: 'Resolve package version variables'

  - task: colinsalmcorner.colinsalmcorner-buildtasks.tag-build-task.tagBuildOrRelease@0
    displayName: 'Tag build with release and preview versions'
    inputs:
      tags: |
       Preview: $(PackageVersion)
    continueOnError: true