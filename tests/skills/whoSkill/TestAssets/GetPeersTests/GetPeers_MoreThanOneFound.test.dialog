{
  "$schema": "https://raw.githubusercontent.com/microsoft/botbuilder-samples/main/experimental/generation/TestBot/TestBot/TestBot.schema",
  "$kind": "Microsoft.Test.Script",
  "userTokenMocks": [
    "nomagiccode.mock"
  ],
  "dialog": "whoSkill",
  "script": [
    {
      "$kind": "Microsoft.Test.UserConversationUpdate",
      "membersAdded": [
        "Bot",
        "User"
      ],
      "membersRemoved": []
    },
    {
      "$kind": "Microsoft.Test.AssertReply",
      "text": "\r\nHi there üñê, thank you for helping the PBX team out with this dogfood for who skill!\r\n    \r\nYou can ask the bot contact/personel related questions in this Teams chat modality (ps. other testing with modalities will follow like speaking to the bot).\r\n"
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "Who are the peers of John Doe?"
    },
    {
      "$kind": "Microsoft.Test.AssertReply",
      "text": "There are 3 colleagues that share the same manager as **John Doe**.",
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    // Simulate clicking on one of the actions button
    {
      "$kind": "Microsoft.Test.UserActivity",
      "activity": {
        "type": "message",
        "value": {
          "intent": "GetProfile",
          "user": "4716A3CD-EE01-42E7-B258-961B295D9217",
          "msteams": {
            "type": "messageBack"
          }
        }
      }
    },
    // Crack the card to inspect the right entity is showing
    {
      "$kind": "Microsoft.Test.AssertReply",
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'",
        "attachments[0].content.body[0].items[0].columns[1].items[0].text == 'Jane Doe'"
      ]
    }
  ]
}