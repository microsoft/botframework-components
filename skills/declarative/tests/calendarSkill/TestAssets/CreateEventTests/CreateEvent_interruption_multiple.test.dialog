{
  "$schema": "https://raw.githubusercontent.com/microsoft/botbuilder-samples/main/experimental/generation/TestBot/TestBot/TestBot.schema",
  "$kind": "Microsoft.Test.Script",
  "httpRequestMocks": [
    "getProfile.mock",
    "getWorkingHours.mock",
    "getContact.mock",
    "getPeople.mock",
    "findMeetingTimes.mock",
    "createEvent.mock"
  ],
  "userTokenMocks": [
    "nomagiccode.mock"
  ],
  "dialog": "Calendar",
  "script": [
    {
      "$kind": "Microsoft.Test.UserActivity",
      "activity": {
        "type": "event",
        "name": "SetTestOptions",
        "value": {
          "randomSeed": 0,
          "randomValue": 0
        }
      }
    },
    {
      "$kind": "Microsoft.Test.UserConversationUpdate",
      "membersAdded": [
        "Bot",
        "User"
      ],
      "membersRemoved": []
    },
    {
      "$kind": "Microsoft.Test.AssertReply",
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.hero'",
        "attachments[0].content.text == 'Hi Megan Bowen üñê, I can help you out with calendar related questions and tasks.'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "new meeting with joni tomorrow at 3pm in seattle titled team meeting"
    },
    {
      "$kind": "Microsoft.Test.AssertReply",
      "assertions": [
        "contains(attachments[0].content.body[0].text, 'Would you like to invite anyone else?')"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "no"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "I've made this a Microsoft Teams meeting."
      ]
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "add an attendee"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Who should I invite?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "add joni"
    },
    {
      "$kind": "Microsoft.Test.AssertReply",
      "assertions": [
        "contains(attachments[0].content.body[0].text, 'Would you like to invite anyone else?')"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "no"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "remove an attendee"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Who should I remove?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "1"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "I've removed test name."
      ]
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "change the date"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "When should I schedule it?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "next wednesday at 1pm"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "add a description"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "What should I set the description to?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "this is a test description"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "change the duration"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "How long should it last?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "1 hour and 30 minutes"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "change the location"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "What should I set the location to?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "Seattle"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "add a teams link"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "I've made this a Microsoft Teams meeting."

      ]
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "remove the teams link"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "I won't make this a Microsoft Teams meeting."
      ]
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "change the title"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "What should I set the title to?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "team meeting"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Does this look right?"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "yes"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "I've created the event."
      ]
    }
  ]
}
