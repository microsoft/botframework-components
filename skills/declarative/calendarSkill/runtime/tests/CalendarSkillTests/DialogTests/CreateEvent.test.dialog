{
  "$schema": "https://raw.githubusercontent.com/microsoft/botbuilder-samples/main/experimental/generation/TestBot/TestBot/TestBot.schema",
  "$kind": "Microsoft.Test.Script",
  "httpRequestMocks": [
    "getProfile.mock",
    "getWorkingHours.mock",
    "getContact.mock",
    "getPeople.mock",
    "findMeetingTimes.mock",
    "createEvent.mock"
  ],
  "userTokenMocks": [
    "nomagiccode.mock"
  ],
  "dialog": "calendarskill",
  "script": [
    {
      "$kind": "Microsoft.Test.UserConversationUpdate",
      "membersAdded": [
        "Bot",
        "User"
      ],
      "membersRemoved": []
    },
    {
      "$kind": "Microsoft.Test.AssertReply",
      "text": "\r\nHi Megan Bowen üñê, thank you for helping the VA Skills team out with this dogfood for calendar skill!\r\n\r\nYou can ask the bot calendar related questions in this Teams chat modality (ps. other testing with modalities will follow like speaking to the bot).\r\n"
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "create a meeting"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "What is the title of the meeting?",
        "What is the title?",
        "What is the meeting about?",
        "What do you want to add as a title?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "test title"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Who will join?",
        "Who do you want to invite?",
        "What attendees do you want to add?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "megan"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Sure, I'll continue with test name, test@test.com.",
        "Got it. I'll move forward with test name, test@test.com.",
        "OK. I'll include test name, test@test.com as attendee."
      ]
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Want to include anyone else? (1) Yes or (2) No",
        "Want to add another attendee? (1) Yes or (2) No",
        "Should I add anyone else? (1) Yes or (2) No",
        "Any other attendees? (1) Yes or (2) No"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "no"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "I've found multiple suggestions when you can meet with test name:",
        "I've found multiple suggestions when you can meet with test name:",
        "I've found the following time when you can meet with test name:"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "1"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Sure, let‚Äôs continue with the 1st option.",
        "OK. I'll continue with November 4 at 3:00 PM.",
        "You got it! I'll schedule this meeting for November 4 at 3:00 PM.",
        "OK. I'll continue with the 1st option."
      ]
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Sure, I‚Äôve added a Teams link for you as well.",
        "OK, I‚Äôll also include a Teams link.",
        "Got it. A Teams link will be added to your meeting.",
        "Great. I've gone ahead and added Teams to this meeting."
      ]
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Please let me know what location you would like to include?",
        "If you want to include a physical location, please call out what I should include for you?"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "test location"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Got it, I will create a meeting on November 4, at 3:00 PM, test title. test name will be invited, and it will take place at test location with a Teams link. Does that sound right? (1) Yes or (2) No",
        "OK, I want to confirm before saving this meeting. It's on November 4, at 3:00 PM, called test title. test name will be invited, and the location is test location with a Teams link included. Do you want to send it? (1) Yes or (2) No",
        "Great. It's almost ready to send. To confirm, this meeting is called test title on November 4, at 3:00 PM for 30 minutes. It'll take place at test location with a Teams link included, and you've invited test name people. Is all of that correct? (1) Yes or (2) No"
      ],
      "assertions": [
        "attachments[0].contentType == 'application/vnd.microsoft.card.adaptive'"
      ]
    },
    {
      "$kind": "Microsoft.Test.UserSays",
      "text": "yes"
    },
    {
      "$kind": "Microsoft.Test.AssertReplyOneOf",
      "text": [
        "Your event has been created.",
        "Your meeting is on your calendar.",
        "The event has been created."
      ]
    }
  ]
}
